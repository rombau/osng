<ui-shared-state id="activeTab" default="1"></ui-shared-state>

<div class="navbar-brand navbar-brand-center" ui-content-for="title">
	<div style="position: relative; ">
		<div style="position: absolute; top: -6px;">
		    <span style="white-space: nowrap;">
		    	<span class="hidden-xs">Zugabgabe </span>ZAT {{$ctrl.information.zat}} <span class="hidden-xs hidden-sm">am {{$ctrl.information.date | date : "dd.MM.yyyy HH:mm"}} Uhr</span> <i class="fa fa-caret-down"></i>
		    </span>
		    <br>
		    <span style="font-size: 10px; line-height: 1.2; white-space: nowrap;">
		    	<span class="visible-xs">
		    		<span ui-if="activeTab == 1">Aufstellung</span>
		    		<span ui-if="activeTab == 2">Wechsel</span>
		    		<span ui-if="activeTab == 3">Einstellungen</span>
		    	</span>
		    	<span class="hidden-xs">{{$ctrl.information.type}}<span class="hidden-sm"> {{$ctrl.information.home ? 'Heim' : 'Auswärts'}}</span> gegen {{$ctrl.information.against.name}}</span>
		    </span>
	    </div>
    </div>
</div>

<div class="btn-group pull-right" ui-content-for="navbarAction">
	<a ui-set="{'activeTab': 1}" ui-turn-off="leftSwipe"
	    ui-class="{'active': activeTab == 1}" class="btn btn-navbar">
	    <i class="fa fa-th"></i><span class="hidden-xs"> Aufstellung</span>
	</a>
	<a ui-set="{'activeTab': 2}" 
	    ui-class="{'active': activeTab == 2}" class="btn btn-navbar">
	    <i class="fa fa-random"></i><span class="hidden-xs"> Wechsel</span>
	</a>
	<a ui-set="{'activeTab': 3}" ui-turn-off="leftSwipe"
	    ui-class="{'active': activeTab == 3}" class="btn btn-navbar">
	    <i class="fa fa-gears"></i><span class="hidden-xs"> Einstellungen</span>
	</a>
    <a class="btn btn-navbar">
		<i class="fa fa-folder-open-o"></i> <span class="hidden-xs">Laden</span>
    </a>
    <a class="btn btn-navbar" ng-click="$ctrl.save()">
    	<span style="color:red;">
        	<i class="fa fa-save"></i> <span class="hidden-xs">Speichern</span>
        </span>
    </a>
</div>

<div class="scrollable">
	<div class="scrollable-content">
    	<div class="section">

	      	<div ui-if="activeTab <= 2" style="float:left;">
	      	
		    	<div class="grid-border">
			    	<div class="grid-container">
						<div ng-repeat="row in $ctrl.grid">
							<div ng-repeat="cell in row track by $index" class="grid-cell">
								<player ng-if="cell.id" 
									object="cell" 
									on-move="$ctrl.grid.setPlayer(player, x, y)"
									on-remove="$ctrl.grid.removePlayer(player)"/>
							</div>
						</div>
					</div>
				</div>
				
				<div class="grid-cell" style="margin-left: 2px;"></div>
				<div class="grid-cell"></div>
				<div class="grid-cell"></div>
				<div class="grid-cell"></div>
				<div class="grid-cell"></div>
				<div class="grid-cell keeper-container">
					<div></div>
					<player ng-if="$ctrl.getKeeper()" 
						object="$ctrl.getKeeper()" 
						on-move="$ctrl.grid.setPlayer(player, x, y)"
						on-remove="$ctrl.grid.removePlayer(player)"></player>
				</div>
	
				<h5 style="clear: both; padding-top: 10px;"><b>Ersatzbank</b></h5>
				<div class="subst-border">
					<div class="subst-container">
						<div ng-repeat="cell in $ctrl.getSubst() track by $index" class="grid-cell">
							<player ng-if="cell.id" 
								object="cell" 
								on-move="$ctrl.grid.setPlayer(player, x, y)"
								on-remove="$ctrl.grid.removePlayer(player)"/>
						</div>
					</div>
				</div>

				<div ui-if="activeTab == 1">
					<h5><b>Statistik</b></h5>
					<div style="margin-bottom: 10px;">
						Ø Alter: 26.40<br>
						Ø Skill: 51.34<br>
						Ø Opti: 84.66</div>
				</div>
				
				<a ui-if="activeTab == 1" ui-toggle="leftSwipe" class="selection-container-button visible-xs"><i class="fa fa-user-plus"></i></a>
				
			    <div class="selection-container" 
			    	ui-if="activeTab == 1" 
			    	ui-class="{'visible': leftSwipe == true}"
			    	ui-turn-off="leftSwipe">
			    	
			    	<div ng-repeat="player in $ctrl.players" style="padding-top: 5px; width: 100%;">
			    		<div class="grid-cell">
		    				<div class="grid-face grid-face-{{player.pos}} noselect btn-group pull-right"
		    					style="background-image: url('/faceprev.php?sid={{player.id}}'); opacity: 0.5; cursor: inherit;"></div>
		    				<player ng-if="!player.isSet()"
		    					object="player" on-move="$ctrl.grid.setPlayer(player, x, y)"></player>
			    		</div>
			    		<div class="noselect player-info">
							<div class="noselect"><a href="javascript:spielerinfo({{player.id}})" 
								class="{{player.pos}}" >{{player.name}}</a></div>
							<div class="noselect">
								Mor<span class="hidden-xs">al</span> {{player.moral}} / 
								Fit<span class="hidden-xs">ness</span> {{player.fitness}} - 
								<span class="hidden-xs">Skill</span> {{player.skill | number : 2}} / 
								<span class="hidden-xs">Opti</span> <b>{{player.opti | number : 2}}</b>
								<span ng-if="player.sonder">/ {{player.sonder}}</span>
							</div>
						</div>
			    	</div>
			    	
			    </div>
			    
			</div>

			<div ui-if="activeTab == 2" class="changes-container">
			
				<h5 style="margin-bottom: 4px;"><b>Einwechslungen</b></h5>
				<div class="list-group">
					<div ng-repeat="adjustment in $ctrl.adjustments">
						<div ng-if="adjustment.option.item==1" class="list-group-item">
							<span ng-bind-html="adjustment.text"></span> <a style="margin-left: 5px;"><b><i class="fa fa-trash"></i></b></a>
						</div> 
					</div> 
				</div>

				<h5 style="margin-top: 15px; margin-bottom: 4px;"><b>Positionswechsel</b></h5>
				<div class="list-group">
					<div ng-repeat="adjustment in $ctrl.adjustments">
						<div ng-if="adjustment.option.item==5" class="list-group-item">
							<span ng-bind-html="adjustment.text"></span> <a style="margin-left: 5px;"><b><i class="fa fa-trash"></i></b></a>
						</div> 
					</div> 
				</div>
			  	
			</div>
	
			<div ui-if="activeTab == 3">
	      
				<h5><b>Aktionen</b></h5>	
				<div class="list-group">
					<div ng-repeat="adjustment in $ctrl.adjustments">
						<div ng-if="adjustment.option.page==1 && adjustment.option.item!=1 && adjustment.option.item!=5" class="list-group-item">
							<span ng-bind-html="adjustment.text"></span> <a style="margin-left: 5px;"><b><i class="fa fa-trash"></i></b></a>
						</div> 
					</div> 
				</div>
				<div ng-repeat="option in $ctrl.options" class="hidden-xs btn-group">
					<button ng-if="option.page==1 && option.item!=1 && option.item!=5" class="btn btn-primary" ng-click="$ctrl.addAdjustment(option)">
						<span ng-bind-html="option.text"></span> 
					</button>
				</div>
	      		
	      		<h5 style="margin-top: 15px;"><b>Einstellungen</b></h5>
	      		<div class="list-group">
					<div ng-repeat="adjustment in $ctrl.adjustments">
						<div ng-if="adjustment.option.page==2 && adjustment.option.item<16" class="list-group-item">
							<span ng-bind-html="adjustment.text"></span> <a style="margin-left: 5px;"><i class="fa fa-trash"></i></a>
						</div> 
					</div> 
				</div>
				<div ng-repeat="option in $ctrl.options" class="hidden-xs btn-group">
					<button ng-if="option.page==2 && option.item<16" class="btn btn-primary" ng-click="$ctrl.addAdjustment(option)">
						<span ng-bind-html="option.text"></span> 
					</button>
				</div>

	      		<h5 style="margin-top: 15px;"><b>Taktiken</b></h5>
	      		<div class="list-group">
					<div ng-repeat="adjustment in $ctrl.adjustments">
						<div ng-if="adjustment.option.page==2 && adjustment.option.item>=16" class="list-group-item">
							<span ng-bind-html="adjustment.text"></span> <a style="margin-left: 5px;"><i class="fa fa-trash"></i></a>
						</div> 
					</div> 
				</div>
				<div ng-repeat="option in $ctrl.options" class="hidden-xs btn-group">
					<button ng-if="option.page==2 && option.item>=16" class="btn btn-primary" ng-click="$ctrl.addAdjustment(option)">
						<span ng-bind-html="option.text"></span> 
					</button>
				</div>
	      
	      		<a ui-toggle="leftSwipe" class="selection-container-button visible-xs"><i class="fa fa-plus"></i></a>
							
			    <div class="selection-container visible-xs" ui-class="{'visible': leftSwipe == true}"
			    	ui-turn-off="leftSwipe">
			    	
					<div class="list-group">
						<div ng-repeat="option in $ctrl.options">
							<a ng-if="option.item!=1" class="list-group-item" ng-click="$ctrl.addAdjustment(option)">
								<i class="fa fa-caret-square-o-right"></i> 
								<span ng-bind-html="option.text"></span> 
							</a>
						</div> 
					</div>
			    	
			    </div>

			</div>

		</div>
	</div>
</div>

<div ui-content-for="modals">
	<div class="modal" ui-if="action" ui-state='action'>
		<div class="modal-backdrop in"></div>
    	<div class="modal-dialog">
      		<div class="modal-content">
        		<div class="modal-header">
          			<button class="close" ui-turn-off="action">&times;</button>
          			<h4 class="modal-title" >{{$ctrl.option.text}}</h4>
        		</div>
        		<div class="modal-body">
					<div ng-repeat="line in $ctrl.adjustmentForm.lines" class="row" style="margin: 0px;">
						<label for="sel">{{line.label}}</label>
						<div ng-repeat="combo in line.combos" class="col-xs-{{combo.width}} combo">
							<select class="form-control" id="sel" name="{{combo.name}}" ng-model="combo.value"
								 ng-options="option.value as option.label for option in combo.options">
							</select>
						</div>
					</div>
        		</div>
				<div class="modal-footer">
					<button ui-turn-off="action" class="btn btn-success" ng-click="$ctrl.saveAdjustment()">Speichern</button>
					<button ui-turn-off="action" class="btn btn-primary">Schließen</button>
				</div>
			</div>
		</div>
	</div>
</div>
